<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Productos - Formulario</title>
    <link rel="icon" href="inicio/assets/Logo_oficial_maderera.png" type="image/x-icon">
    <link rel="stylesheet" href="formulario.css">
</head>
<body>
    <h1>Gestión de Productos</h1>

    <div id="formularioContainer" style="display:none;">
        <form id="formProducto" method="POST" action="../backend/modelo/api_productos.php" enctype="multipart/form-data">
    <h2>Formulario de Producto</h2>
    <label>Código: <input type="number" name="codigo" required></label><br>
    <label>Nombre: <input type="text" name="nombre" required></label><br>
    <label>Precio: <input type="number" step="0.01" name="precio" required></label><br>
    <label>Stock: <input type="number" name="stock" required></label><br>
    <label>Descripción: <input type="text" name="descripcion" required></label><br>
    <label>Categoría:
        <select name="id_categoria" required>
            <option value="1">Ferretería</option>
            <option value="2">Hierros</option>
            <option value="5">Pinturas</option>
            <option value="6">Maderas</option>
            <option value="7">Herrajes</option>
            <option value="8">Cons en seco</option>
        </select>
    </label><br>
    <label>Marca: <input type="text" name="marca" required></label><br>

    <label>Imagen: <input type="file" name="imagen" accept="image/*"></label><br>

            <button type="button" onclick="agregarProductoDesdeFormulario()">Agregar</button>
        </form>
    </div>

    <a href="productos.html">Ir a la lista de productos</a>
    <a href="pedidos.html">Ver la lista de pedidos</a>

    <script src="/maderera/Proyecto-final/frontend/js/producto.js"></script>
    <script>
      fetch("../backend/routes/get_user.php")
        .then(res => res.json())
        .then(user => {
          if (user.error) {
            window.location.href = "../backend/routes/login.php";
          } else if (user.rol === "admin") {
            document.getElementById("formularioContainer").style.display = "block";
          } else {
            alert("No tienes permisos para acceder a esta sección");
            window.location.href = "productos.html";
          }
        })
        .catch(err => {
          console.error("Error al verificar usuario:", err);
          window.location.href = "../backend/routes/login.php";
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    
</body>
</html>
